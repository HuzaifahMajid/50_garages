<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Map View</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body{
            background: linearGradient(to bottom right, #fc0000, #ff0314);
        
        }
        #map {
            height: 600px;
        }
        .category-legend {
            position: absolute;
            bottom: 100px;
            left: 10px;
            z-index: 1000;
            background-color: rgb(204, 122, 122);
            padding: 10px;
            border: 1px solid #04ff00;
            border-radius: 5px;
        }
        .header {
            background: linear-gradient(to right, #1477db, #011252); /* Gradient background */
    border-bottom: 2px solid #011252; /* Dark grey bottom border */
    padding: 20px;
    text-align: center;
    font-family: Arial, sans-serif;
    font-size: 24px;
    font-weight: bold;
    color: #252a2f; /* Dark grey text color */
}

    </style>
</head>
<body>
    <div class = "header" >
        Garage Locations Map
    </div>
    
    <div class="category-legend">
        <label>
            <input type="checkbox" id="showValidID" onchange="toggleMarkers()"> ID obtained
        </label>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        var map = L.map('map').setView([40.7128, -74.0060], 12); // Default center for New York City

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
        }).addTo(map);

        var markers = [];

        // Function to add markers based on data
        function addMarkers(data) {
            for (var i = 0; i < data.length; i++) {
                var garage = data[i];
                var marker = L.marker([garage.Latitude, garage.Longitude]).addTo(map);
                var popupContent = `
                    <b>House No:</b> ${garage['House No']}<br>
                    <b>Street Address:</b> ${garage['Street Address']}<br>
                    <b>City:</b> ${garage.City}<br>
                    <b>ID Obtained:</b> ${garage['ID Obtained'] || ''}<br>
                `;
                marker.bindPopup(popupContent);
                marker.idObtained = garage['ID Obtained'] || '';
                markers.push(marker);
                
            }
        }

        // Function to toggle markers based on the "ID obtained" checkbox
        function toggleMarkers() {
            var showValidID = document.getElementById('showValidID').checked;

            for (var i = 0; i < markers.length; i++) {
                var marker = markers[i];
                if (showValidID) {
                    if (!marker.idObtained) {
                        map.removeLayer(marker);
                    } else {
                        map.addLayer(marker);
                    }
                } else {
                    map.addLayer(marker);
                }
            }
        }

        // Load data and add markers
        var data = {{ data | tojson }};
        addMarkers(data);
    </script>
</body>
</html>
